<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="es"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="utf-8" /&gt;</p>
<p class="p1">&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1">&lt;title&gt;Proyecto Atlas â€” Archivo&lt;/title&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>:root{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>--bg:#0b0d10; --panel:#111418; --muted:#2a2f36; --accent:#1f6feb; --text:#e6e6e6; --sub:#a6b0bb;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>--radius:16px;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>*{box-sizing:border-box}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>header{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>position:sticky;top:0;z-index:10;background:linear-gradient(180deg,#0b0d10,#0b0d10ee 80%,transparent);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>border-bottom:1px solid #1c2128;padding:14px 18px</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.brand{display:flex;gap:12px;align-items:center;max-width:1100px;margin:auto}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.badge{width:40px;height:40px;border-radius:10px;background:#182032;border:1px solid #2a3442;display:grid;place-items:center;font-weight:800}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.meta{line-height:1.2}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.meta h1{margin:0;font-size:18px;letter-spacing:.4px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.meta .ref{font-size:12px;color:var(--sub);opacity:.85}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>main{max-width:1100px;margin:22px auto;padding:0 18px;display:grid;grid-template-columns:260px 1fr;gap:18px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>@media (max-width:960px){ main{grid-template-columns:1fr} }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>/* Sidebar */</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.side{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>background:var(--panel);border:1px solid var(--muted);border-radius:var(--radius);padding:14px;position:sticky;top:78px;height:max-content</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.side h3{margin:0 0 8px 0;font-size:14px;color:var(--sub);text-transform:uppercase;letter-spacing:.12em}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.doclist{display:flex;flex-direction:column;gap:8px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.doc{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>display:flex;justify-content:space-between;align-items:center;gap:8px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>padding:10px 12px;border:1px solid #23262b;border-radius:12px;background:#0e1116;cursor:pointer</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.doc[aria-current="true"]{outline:2px solid var(--accent)}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.doc .name{font-size:14px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.doc .lock{font-size:12px;opacity:.8}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>/* Content card */</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.card{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>background:var(--panel);border:1px solid var(--muted);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>border-radius:var(--radius);padding:16px;box-shadow:0 14px 30px rgba(0,0,0,.3)</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.row{display:flex;flex-wrap:wrap;gap:16px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.col{flex:1 1 320px;min-width:280px}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.imgbox{border:1px solid #23262b;border-radius:12px;overflow:hidden;background:#0e1116}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>#docImage{display:block;width:100%;height:auto;filter:brightness(var(--b,1)) contrast(var(--c,1));transition:filter .2s ease}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.controls{display:flex;gap:14px;flex-wrap:wrap;margin-top:10px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.controls label{font-size:12px;color:var(--sub);display:flex;flex-direction:column;gap:6px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>input[type="range"]{width:200px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>button{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>background:var(--accent);color:white;border:none;border-radius:12px;padding:10px 14px;cursor:pointer;font-weight:600</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>button.secondary{background:#1b232d}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>button.ghost{background:transparent;border:1px solid #2a2f36}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.hint{font-size:12px;color:var(--sub);margin-top:6px}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.notes{border:1px dashed #2a2f36;border-radius:12px;padding:10px;background:#0e1116}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.notes textarea{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>width:100%;min-height:160px;background:transparent;color:var(--text);border:none;outline:none;resize:vertical;font:inherit</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.nav{display:flex;justify-content:space-between;gap:8px;margin-top:12px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.tag{display:inline-flex;gap:8px;align-items:center;font-size:12px;color:var(--sub)}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>/* Modal */</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>dialog{border:none;border-radius:16px;padding:0;max-width:420px;width:calc(100% - 24px);background:#0e1116;color:var(--text)}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.modal{padding:18px;border:1px solid #2a2f36;border-radius:16px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.modal h3{margin:0 0 10px 0}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.modal p{margin:.2rem 0 .8rem 0;color:var(--sub)}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.modal .row{gap:8px}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>.modal input{flex:1 1 180px;padding:10px;border-radius:10px;border:1px solid #2a2f36;background:#0b0f14;color:var(--text)}</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1">&lt;header&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="brand"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="badge"&gt;AT&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="meta"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;h1&gt;Proyecto Atlas â€” Archivo de Pistas&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="ref"&gt;Expediente: ATLASâ€‘03 Â· Unidad Especial Â· Acceso restringido&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p1">&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;main&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;!-- Sidebar: lista de documentos --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;aside class="side"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;h3&gt;Documentos&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div id="docList" class="doclist" role="list"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="hint" style="margin-top:10px"&gt;Los documentos con candado requieren una clave encontrada en los materiales fÃ­sicos.&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/aside&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;!-- Panel principal --&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;section class="card" aria-live="polite"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="tag"&gt;Ref: &lt;span id="refId"&gt;â€”&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;h2 id="docTitle" style="margin:.3rem 0 0.6rem 0"&gt;Documento&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;p id="docIntro" class="hint"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="imgbox"&gt;&lt;img id="docImage" alt=""&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="controls"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label&gt;Brillo</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="br" type="range" min="0.5" max="2" step="0.01" value="1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;label&gt;Contraste</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="ct" type="range" min="0.5" max="2" step="0.01" value="1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="reveal"&gt;Usar pista (autoâ€‘ajuste)&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="reset" class="secondary"&gt;Reiniciar&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="download" class="ghost"&gt;Descargar&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;p class="hint"&gt;Consejo: la verdad a veces aparece en las sombras.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;h3 style="margin:4px 0 8px 0"&gt;Notas&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="notes"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;textarea id="notes" placeholder="Anota aquÃ­ tus hallazgos. Se guardan automÃ¡ticamente en este navegador."&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="nav"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="prev" class="ghost"&gt;â† Anterior&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="next"&gt;Siguiente â†’&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/section&gt;</p>
<p class="p1">&lt;/main&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;!-- Modal de desbloqueo --&gt;</p>
<p class="p1">&lt;dialog id="unlockDialog"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;form method="dialog" class="modal"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;h3&gt;Desbloquear documento&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;p&gt;Introduce la clave encontrada en el caso para acceder.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;input id="unlockInput" placeholder="Ej.: Carmen1706" autocomplete="off" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button id="unlockBtn" value="ok"&gt;Desbloquear&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button value="cancel" class="ghost"&gt;Cancelar&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;p id="unlockMsg" class="hint"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/form&gt;</p>
<p class="p1">&lt;/dialog&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">/* ====== Datos del juego (edÃ­talos) ====== */</p>
<p class="p1">const DOCS = [</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>id:"doc1",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title:"Foto del laboratorio â€” Acto 1",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ref:"ATLASâ€‘03/DOCâ€‘1",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>intro:"Imagen encontrada tras revisar la agenda de VÃ­ctor. Ajusta brillo/contraste para revelar detalles.",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>img:"A_photograph_captures_the_interior_of_a_dimly_lit_.png", // coloca aquÃ­ la ruta real</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>auto:{b:1.35,c:1.6},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>locked:false</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>id:"doc2",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title:"SecciÃ³n 2 (bloqueada)",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ref:"ATLASâ€‘03/DOCâ€‘2",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>intro:"Contenido protegido. Requiere la clave descubierta en el Acto 1.",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>img:"placeholder_locked.jpg", // opcional: una imagen borrosa/candado</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>auto:{b:1,c:1},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>locked:true,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>pass:"Carmen1706" // â† Clave de ejemplo</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>id:"doc3",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>title:"Documento final (bloqueado)",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ref:"ATLASâ€‘03/DOCâ€‘3",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>intro:"Acceso restringido. Necesitas una segunda clave del Acto 2.",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>img:"placeholder_locked.jpg",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>auto:{b:1,c:1},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>locked:true,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>pass:"MUELLE" // â† Clave de ejemplo</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Estado y utilidades ====== */</p>
<p class="p1">const $ = sel =&gt; document.querySelector(sel);</p>
<p class="p1">const stateKey = "atlas_web_state_v1";</p>
<p class="p1">const loadState = ()=&gt; JSON.parse(localStorage.getItem(stateKey) || "{}");</p>
<p class="p1">const saveState = s =&gt; localStorage.setItem(stateKey, JSON.stringify(s));</p>
<p class="p2"><br></p>
<p class="p1">let state = loadState();</p>
<p class="p1">if(!state.unlocked) state.unlocked = { doc1:true }; // el doc1 estÃ¡ abierto por defecto</p>
<p class="p1">if(!state.notes) state.notes = {};</p>
<p class="p1">if(!state.current) state.current = "doc1";</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Render lista lateral ====== */</p>
<p class="p1">const docList = $("#docList");</p>
<p class="p1">function renderList(){</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>docList.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>DOCS.forEach(d=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const li = document.createElement("button");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>li.className = "doc";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>li.setAttribute("role","listitem");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>li.dataset.id = d.id;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const name = document.createElement("span");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>name.className="name";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>name.textContent = d.title;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const lock = document.createElement("span");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>lock.className="lock";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const isOpen = state.unlocked[d.id];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>lock.textContent = d.locked &amp;&amp; !isOpen ? "ğŸ”’" : "ğŸ”“";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>li.appendChild(name); li.appendChild(lock);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if(state.current===d.id) li.setAttribute("aria-current","true");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>li.onclick = ()=&gt; openDoc(d.id);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>docList.appendChild(li);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Abrir documento ====== */</p>
<p class="p1">function openDoc(id){</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>state.current = id; saveState(state);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const d = DOCS.find(x=&gt;x.id===id);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const isOpen = state.unlocked[id] || !d.locked;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>$("#refId").textContent = d.ref;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>$("#docTitle").textContent = d.title;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>$("#docIntro").textContent = d.intro;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// reset filtros</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>$("#br").value = 1; $("#ct").value = 1; setFilters();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(isOpen){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>$("#docImage").src = d.img;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>$("#docImage").alt = d.title;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>$("#docImage").src = d.img || "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>$("#docImage").alt = "Documento bloqueado";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// lanzar modal de desbloqueo</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>unlockDialog.showModal();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// Notas</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>$("#notes").value = state.notes[id] || "";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>renderList(); // refrescar estado de candados</p>
<p class="p1">}</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Filtros ====== */</p>
<p class="p1">const setFilters = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const img = $("#docImage");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>img.style.setProperty("--b", $("#br").value);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>img.style.setProperty("--c", $("#ct").value);</p>
<p class="p1">};</p>
<p class="p1">$("#br").oninput = $("#ct").oninput = setFilters;</p>
<p class="p1">$("#reveal").onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const d = DOCS.find(x=&gt;x.id===state.current);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>$("#br").value = d.auto.b; $("#ct").value = d.auto.c; setFilters();</p>
<p class="p1">};</p>
<p class="p1">$("#reset").onclick = ()=&gt;{ $("#br").value = 1; $("#ct").value = 1; setFilters(); };</p>
<p class="p1">$("#download").onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const d = DOCS.find(x=&gt;x.id===state.current);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(!d) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const a = document.createElement("a"); a.href = d.img; a.download = d.img.split("/").pop();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>a.click();</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Notas persistentes ====== */</p>
<p class="p1">$("#notes").addEventListener("input", e=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>state.notes[state.current] = e.target.value; saveState(state);</p>
<p class="p1">});</p>
<p class="p2"><br></p>
<p class="p1">/* ====== NavegaciÃ³n ====== */</p>
<p class="p1">$("#prev").onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const idx = DOCS.findIndex(x=&gt;x.id===state.current);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(idx&gt;0) openDoc(DOCS[idx-1].id);</p>
<p class="p1">};</p>
<p class="p1">$("#next").onclick = ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const idx = DOCS.findIndex(x=&gt;x.id===state.current);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if(idx&lt;DOCS.length-1) openDoc(DOCS[idx+1].id);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Desbloqueo ====== */</p>
<p class="p1">const unlockDialog = $("#unlockDialog");</p>
<p class="p1">$("#unlockBtn").onclick = (ev)=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>ev.preventDefault();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const code = $("#unlockInput").value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const d = DOCS.find(x=&gt;x.id===state.current);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if((d.pass||"").toLowerCase() === code.toLowerCase()){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>state.unlocked[d.id] = true; saveState(state);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>$("#unlockMsg").textContent = "Desbloqueado âœ…";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>setTimeout(()=&gt;{ unlockDialog.close(); openDoc(d.id); }, 300);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>$("#unlockMsg").textContent = "Clave incorrecta.";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">};</p>
<p class="p1">unlockDialog.addEventListener("close", ()=&gt;{ $("#unlockInput").value=""; $("#unlockMsg").textContent=""; });</p>
<p class="p2"><br></p>
<p class="p1">/* ====== Inicial ====== */</p>
<p class="p1">renderList();</p>
<p class="p1">openDoc(state.current);</p>
<p class="p2"><br></p>
<p class="p1">// Doble toque sobre la imagen = autoâ€‘ajuste (mÃ³vil)</p>
<p class="p1">let t=0; $("#docImage").addEventListener('touchend', ()=&gt;{ const now=Date.now(); if(now-t&lt;350){ $("#reveal").click(); } t=now;});</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
